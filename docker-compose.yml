version: '3.8'

services:
  backend:
    build: ./backend
    ports:
      - "8000:80"
    environment:
      # Discovery configuration (required)
      - DISCOVERY_CIDR_RANGES=192.168.1.0/24
      # Discovery configuration (optional - defaults shown)
      - DISCOVERY_INTERVAL_SECONDS=60
      - DISCOVERY_MAX_PARALLEL=10
      - DISCOVERY_TIMEOUT_SECONDS=2.0
      - DISCOVERY_PORT=11434
      # CORS and security
      - ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
      - TRUSTED_HOSTS=localhost,127.0.0.1
    network_mode: host  # Required for network discovery to work properly

  frontend:
    build: ./frontend
    ports:
      - "3000:80"
    environment:
      - VITE_LLMMONITOR_URL=http://localhost:8000
